library(ggplot2)
library(tidyverse)
library(dplyr)

# Loading the data set from the working directory
load("SubstationRPD.Rdata")

# Assigning name to data substation.data
data <- substation.data

# Producing a summary of the data set
summary(substation.data)
str(data)

data[["Substation"]] = factor(data[["Substation"]])


data1 <- data[,1:3]
head(data1)

hist(data1$'1',
     main = "Power delivered to all 410 substations in the first 10 min",
     xlab = "real power delivered by station")

date <- c(data$Date)
date
subs_avg <- c(rowMeans(data[,-1:-2]))
head(subs_avg)
data <- data %>%
  mutate(subs_avg = subs_avg)
subz_1 <- data[,-3:-146]
head(subz_1)

mean(subz_1$subs_avg)


ggplot(data = subz_1, mapping = aes(x = date, y = factor(subs_avg), colour = factor(data))) +
  geom_line(show.legend = F) +
geom_hline(yintercept = mean(subz_1$subs_avg), colour = "black", size = 1.5)
